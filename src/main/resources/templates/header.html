<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<body>

	<header th:fragment="header" class="site-header">
		<div class="site-header__inner">
			<!-- 左：ロゴ（SVG） -->
			<div class="header-left">

				<a th:href="@{/shop}" class="site-logo">
					<img th:src="@{/images/logo_01_black.svg}" alt="KEN INTERIOR SHOP" class="site-logo__img">
				</a>

			</div>

			<!-- 追加：中央（検索やメニューをここに） -->
			<div class="header-center">

			</div>

			<!-- 右：アクション群 -->
			<div class="header-right">

				<!-- カート（SVG + バッジ） -->
				<a th:href="@{/cart}" class="cart">
					<!-- 0件のときは is-hidden を付与してCSSで非表示 
					<span class="cart-count" th:text="${session.cartCount} ?: 0"
						th:classappend="(${session.cartCount} ?: 0) == 0 ? ' is-hidden' : ''"
						th:attr="aria-label=|カート内は${(session.cartCount ?: 0)}点です|">
						0
					</span>-->
					<!-- header.html -->
					<span
					  id="cart-count-badge"
					  class="cart-count"
					  th:text="${session.cartCount} ?: 0"
					  th:attr="aria-label=|カート内は${(session.cartCount ?: 0)}点です|, hidden=${(session.cartCount ?: 0) == 0 ? 'hidden' : null}"
					>0</span>
					<img th:src="@{/images/icon_cart_black.svg}" alt="cart" class="cart-icon">
				</a>


				<p th:if="${session.loginUser != null}"> ようこそ、<span th:text="${session.loginUser.memberName}"></span> さん
				</p>


				<!--<a th:href="@{/login}" class="header-link">ログイン</a>-->

				<!-- 未ログイン時のみ表示 -->

				<a sec:authorize="isAnonymous()" th:href="@{/login}" class="header-link">ログイン</a>

				<!-- ログイン済み時のみ表示 -->
				<form sec:authorize="isAuthenticated()" th:action="@{/logout}" method="post" style="display:inline;">
					<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
					<button type="submit" class="header-link" style="background:none;border:none;cursor:pointer;">
						ログアウト
					</button>
				</form>
				<a th:href="@{/shop/registerform}" class="header-link">会員登録</a>

			</div>
	</header>

</body>

</html>